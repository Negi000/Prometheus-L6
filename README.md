# 🎯 Prometheus-L6

LOTO6戦略的投資支援システム - AI駆動型の包括的分析・意思決定支援ツール

## 🎨 最新アップデート (v2.0)

### ✨ **SVGアイコン導入 & UI/UX刷新**
- **プロ級デザイン**: 幾何学記号（■●◆▲▼）を廃止し、スタイリッシュなSVGアイコンを全面導入
- **Feather Icons風**: モダンで直感的なベクターアイコンによる視認性向上
- **カラー統合**: 成功=緑、エラー=赤、警告=オレンジの統一カラーシステム
- **レスポンシブ対応**: 全デバイスで最適表示される高品質UI

### 🔧 **堅牢性向上**
- **列名自動統一**: CSVデータの「回」列を「第何回」に自動変換
- **エラーハンドリング強化**: データ読み込み・特徴量生成時の安定性向上
- **バックテスト修正**: 「第何回」列エラーの完全解決
- **データ検証**: より柔軟で堅牢なデータ処理エンジン

### 📊 **改善されたUI要素**
- **⚡ ヘッダー**: 稲妻アイコンでブランド力強化
- **📋 ナビゲーション**: 機能別専用アイコンで直感的操作
- **📈 ダッシュボード**: 分析項目ごとの視覚的アイコン表示
- **⭐ 戦略管理**: 学習・バックテスト状況の明確化
- **🎯 予測生成**: ポートフォリオ作成の視覚的ガイド
- **📊 シミュレーション**: リスク分析の分かりやすい表示

---

## 📋 概要

Prometheus-L6は、LOTO6を「運任せのギャンブル」から「データ駆動型の戦略的投資」へと昇華させるためのローカル実行型ツールです。高度なデータ分析とAI技術を駆使し、統計的優位性（エッジ）を追求することで、長期的な収益性を最大化する意思決定支援を提供します。

### ⚡ 主要機能

- **📊 データ分析ダッシュボード**: 過去データの詳細分析と可視化
- **⚙️ 適応学習システム**: AI による自己進化型戦略生成
- **🎯 ポートフォリオ生成**: 軸数字・除外数字対応の最適化
- **💰 ケリー基準**: 理論に基づく最適投資額算出
- **🧪 モンテカルロシミュレーション**: 将来リスクの定量評価
- **⚖️ 戦略比較**: 複数戦略の性能比較・選択支援

## 🛠️ 必要要件

### システム要件
- **OS**: Windows 10/11, macOS, Linux
- **Python**: 3.9以上
- **メモリ**: 4GB以上推奨
- **ストレージ**: 1GB以上の空き容量

### 必要データファイル
1. **LOTO6情報.csv** - LOTO6過去当選データ
   - 列: 第何回, 本数字1-6, ボーナス数字, セット球, 本数字合計 など
   - 文字エンコーディング: Shift-JIS
2. **allloto6.txt** - 全組み合わせデータ（オプション）

## 📦 インストール手順

### 1. プロジェクトのクローン/ダウンロード
```bash
# このディレクトリ構造を作成
Prometheus-L6/
├── main.py
├── config.ini
├── requirements.txt
├── data/
│   ├── LOTO6情報.csv
│   └── allloto6.txt
├── app/
└── output/
```

### 2. Python環境のセットアップ
```bash
# 仮想環境の作成（推奨）
python -m venv venv

# 仮想環境の有効化
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# 依存パッケージのインストール
pip install -r requirements.txt
```

### 3. データファイルの配置
- `data/LOTO6情報.csv` に過去の当選データを配置
- 必要に応じて `config.ini` の設定を調整

### 4. アプリケーションの起動
```bash
streamlit run main.py
```

ブラウザで `http://localhost:8501` にアクセスしてください。

## 📚 使用方法

### 初回セットアップ
1. **ダッシュボード**でデータの読み込み確認
2. 特徴量生成を実行（初回のみ、数分要します）
3. システム情報で動作確認

### 基本的なワークフロー

#### 1️⃣ 戦略の学習
1. 「⚙️ 戦略管理」→ 「新規戦略学習」
2. バックテスト期間とパラメータを設定
3. 学習実行（10-30分程度）

#### 2️⃣ 予測の生成
1. 「🔮 予測生成」で学習済み戦略を選択
2. 購入条件（口数、軸数字等）を設定
3. ポートフォリオ生成

#### 3️⃣ リスク評価
1. 「🧪 シミュレーション」で戦略性能を評価
2. 複数戦略の比較検討
3. 最適戦略の選択

## 🧠 核心技術：適応学習システム

本ツールの中核を成すのは、ユーザー定義の「適応学習・バックテストエンジン」です：

### 学習サイクル
1. **直近100回のデータ**を使用してAIモデルを学習
2. **次の1回を予測**してポートフォリオ生成
3. **実際の結果と比較**して性能評価
4. **フィードバック**により次の学習で改善

### バックテスト方式
- スライディングウィンドウ法による厳密な過去検証
- データリーク完全防止
- 継続的な戦略改善

## 📊 主要アルゴリズム

### 1. 特徴量エンジニアリング
- **時系列特徴量**: 移動平均、出現ギャップ、トレンド
- **構造的特徴量**: 奇偶比、連続数、合計値分散
- **セット球プロファイル**: カテゴリ情報の数値化

### 2. 機械学習モデル
- **XGBoost**: 勾配ブースティング（デフォルト）
- **拡張予定**: GNN, VAE, 強化学習

### 3. 投資最適化
- **ケリー基準**: 理論的最適投資額
- **逆張り戦略**: 期待収益最大化
- **リスク分散**: コア・サテライト戦略

## ⚙️ 設定ファイル (config.ini)

```ini
[Paths]
loto6_history_csv = ./data/LOTO6情報.csv
database_path = ./output/db/strategies.db

[Parameters]
backtest_window_size = 100
default_purchase_count = 20
ticket_price = 200

[KellyCriterion]
average_win_prize = 3500
odds_b = 17.5
```

## 🚨 重要な注意事項

### 免責事項
- 本ツールは統計的分析に基づく意思決定支援が目的
- **当選は保証されません**
- 投資は自己責任で実行してください
- 過去の実績は将来の結果を保証しません

### 推奨事項
- 必ず少額から開始
- 複数戦略の分散投資
- 定期的な戦略見直し
- ギャンブル依存症への注意

## 📈 パフォーマンス指標

システムが提供する主要指標：

- **平均損益**: 1回あたりの期待収支
- **的中率**: 3等以上、4等以上、5等以上
- **VaR**: バリュー・アット・リスク（95%, 99%）
- **シャープレシオ**: リスク調整後リターン
- **ROI**: 投資収益率

## 🔧 トラブルシューティング

### よくある問題

1. **データ読み込みエラー**
   - **文字エンコーディングエラー**: `'shift_jis' codec can't decode byte`
     - **原因**: CSVファイルの文字エンコーディングが期待と異なる
     - **解決法**: 
       - Excelで開いて「CSV (カンマ区切り)」として再保存
       - テキストエディタでShift-JISまたはUTF-8として保存
       - システムが自動的に複数エンコーディングを試行
   
   - **ファイルパスエラー**: `FileNotFoundError`
     - **原因**: データファイルが指定された場所にない
     - **解決法**: `data/LOTO6情報.csv` が正しい場所にあることを確認
   
   - **CSVフォーマットエラー**: 列が見つからない
     - **原因**: CSV の列名や構造が期待と異なる
     - **解決法**: 必要な列（回、本数字1-6等）が含まれていることを確認

2. **メモリ不足**
   - バックテスト期間の短縮
   - 購入口数の削減
   - `config.ini` で `backtest_window_size` を100以下に設定

3. **学習時間が長い**
   - ウィンドウサイズの調整（`backtest_window_size` を50-100に設定）
   - XGBoostパラメータの調整
   - CPUコア数の確認

### エンコーディング問題の詳細解決手順

**方法1: Excelを使用**
1. CSVファイルをExcelで開く
2. 「ファイル」→「名前を付けて保存」
3. ファイル形式を「CSV (カンマ区切り) (*.csv)」に選択
4. 保存

**方法2: テキストエディタ使用**
1. CSVファイルをメモ帳やVS Codeで開く
2. 「名前を付けて保存」で文字エンコーディングを「ANSI」または「UTF-8」に設定
3. 保存

**方法3: Pythonスクリプトで変換**
```python
import pandas as pd

# UTF-8で読み込み
df = pd.read_csv('data/LOTO6情報.csv', encoding='utf-8')
# Shift-JISで保存
df.to_csv('data/LOTO6情報_fixed.csv', encoding='shift-jis', index=False)
```

### システム要件確認

```bash
# Python バージョン確認
python --version

# 必要パッケージの確認
pip list | grep -E "(pandas|streamlit|sklearn|xgboost)"

# メモリ使用量確認（起動後）
# タスクマネージャー（Windows）またはActivity Monitor（Mac）で確認
```

## 📝 ライセンス

本プロジェクトは個人利用を前提としています。

## 🤝 貢献

改善提案やバグ報告は Issue でお願いします。

## 📧 サポート

技術的な質問や要望については、プロジェクトの Issue を活用してください。

---

**Prometheus-L6** - AIによる戦略的LOTO6投資の新時代へ 🚀
